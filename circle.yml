dependencies:
  override:
    - npm install --prefix=web
    - npm run build --prefix=web
    - ./web/node_modules/eslint/bin/eslint.js --fix web/.
  cache_directories:
    - web/node_modules
test:
  post:
    - if [[ -n $(git diff) ]]; then git diff > $CIRCLE_ARTIFACTS/cs-issues.patch && exit 1; fi;
    - FILES_WITHOUT_LF_AT_EOF=$(for file in $(git grep --cached -Il ''); do test $(tail -c 1 $file) && echo $file; done); if [[ -n $FILES_WITHOUT_LF_AT_EOF ]]; then echo -e "Some files have missing LF at EOF:\n$FILES_WITHOUT_LF_AT_EOF"; fi;
